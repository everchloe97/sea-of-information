---
title: hoisting

date: 2022-08-03
---

## 면접 질문

자바스크립트의 호이스팅에 대해 알고 계신걸 설명해주세요

## 답변

호이스팅은 var 선언문이나, function 선언문 등을 해당 스코프의 선두로 옮긴 것처럼 동작하는 특성입니다.
자바스크립트에서는 `let`, `const`, `var`, `function`, `class` 등 모든 선언을 호이스팅 합니다. 그러나 `var`과 달리 `let`으로 선언된 변수는 선언문 이전에 참조하면 참조에러 (Reference Error)가 발생합니다. 이는 let으로 선언된 변수는 스코프의 시작에서 변수의 선언까지 `일시적 사각지대(Temporal Dead Zone, TDZ)`에 빠지기 때문입니다.

---

자바의 변수 생성 단계는 다음과 같습니다.

1. **선언 단계 (Declaration phase)**

    변수를 [실행 컨텍스트](https://poiemaweb.com/js-execution-context)의 변수 객체(Variable Object)에 등록한다. 이 변수 객체는 스코프가 참조하는 대상이다.

    > 실행 컨텍스트: 실행 가능한 코드가 실행되기 위해 필요한 환경 (실행 가능한 코드: 전역 코드, Eval 코드, 함수 코드)

2. **초기화 단계 (Initialization phase)**

    변수 객체(Variable Object)에 등록한 변수를 위한 공간을 메모리에 확보한다. 여기서 변수는 undefined로 초기화된다.

3. **할당 단계 (Assignment phase)**

    undefined로 초기화된 변수에 실제 값을 할당한다.

#### var

-   var로 선언된 변수는 선언과 초기화가 한번에 이루어집니다. 따라서 변수 선언문 이전에 변수에 접근하여도 스코프에 변수가 존재하기 때문에 에러가 발생하지 않지만, undefined를 반환합니다. 이 후 할당문에 도달하면 비로소 값이 할당됩니다. 이런 현상을 `변수 호이스팅`이라고 합니다.

```js
console.log(yap); //undefined

var yap;
console.log(yap); //undefined

yap = 100;
console.log(yap); //100
```

#### let

-   let은 선언과 초기화가 분리되어 진행됩니다. 스코프에 변수를 등록하지만, 초기화는 변수 선언문에 도달했을 때 이루어집니다. 따라서 선언문 이전에 변수를 참조하려고 하면 참조 에러가 발생합니다. 따라서 스코프의 시작부터 초기화 시작 지점가지는 변수를 참조할 수 없습니다.

> 스코프의 시작 지점부터, 초기화 시작 지점 까지의 구간을 '일시적 사각지대 (Temporal Dead Zone, TDZ)'이라고 한다.

그러면 호이스팅이 발생하지 않는 것이라고 생각할 수 있지만 그렇지 않습니다

```js
let hello = "hi!"; //전역변수

{
    console.log(hello); //Reference Error: hello is not defined
    let hello = "what's up!"; //지역변수
}
```

이 경우 전역 변수인 hello가 출력될 것 같지만, 여기서도 hoisting이 발생하기 때문에 Reference 에러가 발생합니다.

let으로 선언된 변수는 블록 스코프를 가지므로 블록 내에서 선언된 변수는 지역 변수입니다. 지역 변수가 해당 스코프에서 호이스팅이 되고, 블록의 선두부터 초기화가 이루어지는 지점까지 TDZ에 빠집니다. 결국 참조 에러가 발생하게 되는겁니다.

### 예상 꼬리 질문 1

var, let, const 등 다양한 변수 선언 방식이 있는데, 어떤 걸 사용하는 것이 더 좋을까요?

### 예상 꼬리 질문 답변 1

변수 선언에는 기본적으로 const를 사용합니다. 객체를 재할당하는 경우는 흔치 않으므로 const를 사용해 의도치 않은 재할당을 방지해주므로 안전합니다. 원시 값의 경우 가급적 상수를 사용합니다.

let은 재할당이 필요한 경우에만 한정하여 사용하고, 이 때 변수의 스코프는 최대한 좁게 만듭니다.

ES6를 사용하면 var은 되도록 사용하지 않습니다.

---

[참고]
[호이스팅](https://poiemaweb.com/es6-block-scope#13-호이스팅)
